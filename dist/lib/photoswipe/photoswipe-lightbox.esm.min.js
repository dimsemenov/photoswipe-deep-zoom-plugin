/*!
  * PhotoSwipe Lightbox 5.1.5 - https://photoswipe.com
  * (c) 2021 Dmitry Semenov
  */
function t(t,i,s=document){let e=[];if(t instanceof Element)e=[t];else if(t instanceof NodeList||Array.isArray(t))e=Array.from(t);else{const h="string"==typeof t?t:i;h&&(e=Array.from(s.querySelectorAll(h)))}return e}class i{constructor(t,i,s,e){this.pswp=e,this.options=t,this.itemData=i,this.index=s}update(t,i,s){this.elementSize={x:t,y:i},this.panAreaSize=s;const e=this.panAreaSize.x/this.elementSize.x,h=this.panAreaSize.y/this.elementSize.y;this.fit=Math.min(1,e<h?e:h),this.fill=Math.min(1,e>h?e:h),this.vFill=Math.min(1,h),this.initial=this.t(),this.secondary=this.i(),this.max=Math.max(this.initial,this.secondary,this.o()),this.min=Math.min(this.fit,this.initial,this.secondary),this.pswp&&this.pswp.dispatch("zoomLevelsUpdate",{zoomLevels:this,slideData:this.itemData})}u(t){const i=this.options[t+"ZoomLevel"];if(i)return"function"==typeof i?i(this):"fill"===i?this.fill:"fit"===i?this.fit:Number(i)}i(){let t=this.u("secondary");return t||(t=Math.min(1,2.5*this.fit),t*this.elementSize.x>3e3&&(t=3e3/this.elementSize.x),t)}t(){return this.u("initial")||this.fit}o(){const t=this.u("max");return t||Math.max(1,4*this.fit)}}function s(t,s,e){if(t.src&&t.w&&t.h){const{options:h}=s,n=s.viewportSize||function(t,i){if(t.getViewportSizeFn){const s=t.getViewportSizeFn(t,i);if(s)return s}return{x:document.documentElement.clientWidth,y:window.innerHeight}}(h),o=function(t,i){return{x:i.x-(t.paddingLeft||0)-(t.paddingRight||0),y:i.y-(t.paddingTop||0)-(t.paddingBottom||0)}}(h,n),r=new i(h,t,-1);r.update(t.w,t.h,o);const a=document.createElement("img");return a.decoding="async",a.sizes=Math.ceil(t.w*r.initial)+"px",t.srcset&&(a.srcset=t.srcset),a.src=t.src,e&&"decode"in a&&a.decode(),a}}class e{constructor(t,i){this.type=t,i&&Object.assign(this,i)}preventDefault(){this.defaultPrevented=!0}}class h extends class extends class{constructor(){this.l={}}on(t,i){this.l[t]||(this.l[t]=[]),this.l[t].push(i),this.pswp&&this.pswp.on(t,i)}off(t,i){this.l[t]&&(this.l[t]=this.l[t].filter((t=>i!==t))),this.pswp&&this.pswp.off(t,i)}dispatch(t,i){if(this.pswp)return this.pswp.dispatch(t,i);const s=new e(t,i);return this.l?(this.l[t]&&this.l[t].forEach((t=>{t.call(this,s)})),s):s}}{getNumItems(){let t;const{dataSource:i}=this.options;i?i.length?t=i.length:i.gallery&&(i.items||(i.items=this.m(i.gallery)),i.items&&(t=i.items.length)):t=0;return this.dispatch("numItems",{dataSource:i,numItems:t}).numItems}getItemData(t){const{dataSource:i}=this.options;let s;Array.isArray(i)?s=i[t]:i&&i.gallery&&(i.items||(i.items=this.m(i.gallery)),s=i.items[t]);let e=s;e instanceof Element&&(e=this.p(e));return this.dispatch("itemData",{itemData:e||{},index:t}).itemData}m(i){return this.options.children||this.options.childSelector?t(this.options.children,this.options.childSelector,i)||[]:[i]}p(t){const i={element:t},s="A"===t.tagName?t:t.querySelector("a");if(!s)return i;i.src=s.dataset.pswpSrc||s.href,i.srcset=s.dataset.pswpSrcset,i.w=parseInt(s.dataset.pswpWidth,10),i.h=parseInt(s.dataset.pswpHeight,10);const e=t.querySelector("img");return e&&(i.msrc=e.currentSrc||e.src,i.alt=e.getAttribute("alt")),s.dataset.cropped&&(i.thumbCropped=!0),i}}{constructor(t){super(),this.options=t||{},this.g=0}init(){this.onThumbnailsClick=this.onThumbnailsClick.bind(this),t(this.options.gallery,this.options.gallerySelector).forEach((t=>{t.addEventListener("click",this.onThumbnailsClick,!1)}))}onThumbnailsClick(t){if(function(t){if(2===t.which||t.ctrlKey||t.metaKey||t.altKey||t.shiftKey)return!0}(t)||window.pswp||!1===window.navigator.onLine)return;let i={x:t.clientX,y:t.clientY};i.x||i.y||(i=null);const s=this.getClickedIndex(t),e={gallery:t.currentTarget};s>=0&&(t.preventDefault(),this.loadAndOpen(s,e,i))}getClickedIndex(i){if(this.options.getClickedIndexFn)return this.options.getClickedIndexFn.call(this,i);const s=i.target,e=t(this.options.children,this.options.childSelector,i.currentTarget).findIndex((t=>t===s||t.contains(s)));return-1!==e?e:this.options.children||this.options.childSelector?-1:0}loadAndOpen(t,i,s){return!window.pswp&&(this.options.index=t,this.options.initialPointerPos=s,this.shouldOpen=!0,this.preload(t,i),!0)}preload(t,i){const{options:e}=this;i&&(e.dataSource=i);const h=[(n=e.pswpModule,"string"==typeof n?import(n):n)];var n;"function"==typeof e.openPromise&&h.push(e.openPromise()),!1!==e.preloadFirstSlide&&t>=0&&function(t,i){const e=i.getItemData(t);i.dispatch("lazyLoadSlide",{index:t,itemData:e}).defaultPrevented||s(e,i)}(t,this);const o=++this.g;Promise.all(h).then((t=>{if(this.shouldOpen){const i=t[0];this.M(i,o)}}))}M(t,i){if(i!==this.g&&this.shouldOpen)return;if(this.shouldOpen=!1,window.pswp)return;const s="object"==typeof t?new t.default(null,this.options):new t(null,this.options);this.pswp=s,window.pswp=s,Object.keys(this.l).forEach((t=>{this.l[t].forEach((i=>{s.on(t,i)}))})),s.on("destroy",(()=>{this.pswp=null,window.pswp=null})),s.init()}destroy(){this.pswp&&this.pswp.close(),this.shouldOpen=!1,this.l=null,t(this.options.gallery,this.options.gallerySelector).forEach((t=>{t.removeEventListener("click",this.onThumbnailsClick,!1)}))}}export{h as default};
